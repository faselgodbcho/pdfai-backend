<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Upload PDF to PDF-AI</title>
  </head>
  <body>
    <h2>Upload PDF to Chat</h2>

    <label for="title">Session Title:</label><br />
    <input type="text" id="title" name="title" required /><br /><br />

    <label for="pdf">Upload PDF:</label><br />
    <input
      type="file"
      id="pdf"
      name="pdf"
      accept="application/pdf"
      required
    /><br /><br />

    <button id="upload">Upload</button>

    <p id="status"></p>

    <script>
      const status = document.getElementById("status");
      const uploadbtn = document.getElementById("upload");

      uploadbtn.addEventListener("click", async (e) => {
        const token =
          "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzUxMzY2MjU3LCJpYXQiOjE3NTEzNjUzNTcsImp0aSI6ImM1MWY5YTkxZWI2NTQ5N2ViYmFlZGVkZjQ0OWFiZjNhIiwidXNlcl9pZCI6MX0.fWKaDPFntiViu0RMQufL1rr5UazzK9m5lViQOL2V1K8";

        const formData = new FormData();
        formData.append("title", document.getElementById("title").value);
        formData.append("file", document.getElementById("pdf").files[0]);

        try {
          const response = await fetch("https://localhost:8000/files/upload/", {
            method: "POST",
            headers: {
              Authorization: `Bearer ${token}`,
            },
            body: formData,
          });

          const data = await response.text();
          console.log(data);

          if (response.ok) {
            status.innerText = "✅ Upload successful! Chat session created.";
          } else {
            status.innerText = `❌ Upload failed: ${JSON.stringify(data)}`;
          }
        } catch (error) {
          status.innerText = `❌ Error: ${error.message}`;
        }
      });
    </script>
  </body>
</html>
